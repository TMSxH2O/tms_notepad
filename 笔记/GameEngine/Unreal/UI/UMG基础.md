
#UI #基础 #功能学习

UMG，即 Unreal Motion Graphics，是 Unreal Engine 中用于用户界面和交互的工具。UMG 提供了可视化的界面编辑器，使开发人员能够轻松地设计和实现游戏中地各种用户界面，包括菜单、HUD（头顶信息显式）、游戏界面等。

> [!info] 小知识
> UMG 基于 Slate 封装实现

# 1.常用控件介绍

## 1.1.UI层级

UI的层级影响的是它们的渲染顺序。

> [!question] 这个说法到底对不对？
> 每个可以显示的控件上，都有 `ZOrder` 属性，可以用来控制它的渲染顺序，那层级真的是用来控制UI渲染顺序的吗？
> 
> 目前感觉它只是单纯用来控制控件树的，没有其他效果？
> 
> ==TODO== 想办法验证

`ZOrder` 越大的控件，覆盖在越上面

## 1.2.画布面板

画布面板控件，Canvas Panel。是UI里非常重要的一个空间，可以将它理解为是一张白纸，其他的UI就是在这张白纸上绘画来展示。

画布的主要作用，是用来调整控件的位置，超出画布之外的空间不渲染。画布本身没有位置，只能通过设置分辨率的方式设置大小。

> [!info] 补充
> 在 UE4 中，默认的UI层级中就添加了画布；在 UE5 中取消了默认的画布，需要手动添加，增强了使用的灵活性。

> [!todo] 原理推测
> 这里的画布，本质上应该就是一个 RenderTarget

### Tool Tip Text / Tool Tip Widget

一般其实不会做到画布上。作用是，当鼠标悬停在对应的控件上时，弹出 Text 或一个新的 UI 窗口，进行提示。

相对来说 *Tool Tip Widget* 可能在实际的游戏中会更加常见一点，比如背包系统中，悬停到不同的装备上，就弹出窗口展示装备的详细信息。

### **【重要】** Visbility 

设置 UI 控件的可见性，包含以下几个可选的值：

- **Visiable**：可见的，默认值，正常显示UI控件；
- **Collapsed**：坍缩，不再显示UI控件，同时控件会让出它占用的 Layout（影响布局控件）；
- **Hidden**：隐藏，不再显示UI控件，但依然占用 Layout；
- **Not Hit-Testable（Self & All Children）**：正常显示UI控件，但不再处理自己包括所有自节点的交互事件；
- **Not Hit-Testable（Only Self）**：同上，但只影响自己；

> [!question] `Not Hit-Testable` 可以深入看看原理？
> ==TODO==

## 1.3.文字控件（或图像控件等常用的基础显示控件）

### 插槽

锚点，Anchors，用于适配 UI 控件的相对位置（9宫格布局），通常包含三种情况：

- **九点适配**：选择九宫格中，某个小格；
- **单轴适配**：首先分横纵两个方向，然后选择对应方向的左中右或者上中下的位置。缩放时，所选的条形方向上根据指定的间隔控制顶点缩放；
- **父节点尺寸适配**：分别设置周围四个方向，相对父节点尺寸的像素大小，比较常见的用法，比如一张背景图，设置四个方向都为0，不管父节点大小如何变化，这张背景图都能把整个父节点的尺寸都覆盖到；

> [!warning] 注意
> 锚点的设置，影响的是相对于这个点的距离计算。控件的缩放不是由锚点来控制。

### 大小到内容

勾选后无法再手动修改大小，根据指定的图片大小来直接控制控件的尺寸。

可以通过修改 **笔刷**（可以设置贴图，也可以不设置贴图是纯色的色块）里的图像大小，来强行修改贴图大小，进而影响这里的控件大小。

# 2.实际使用

## 2.1.添加到场景使用

1. 使用 *创建控件* 节点，创建对应 UI 文件的实例对象；
2. 使用 *添加到视口* 节点，将 UI 实例对象显示到视口；

添加到视口时，需要指定到具体的玩家控制器。

## 显示鼠标指针

默认情况下，会隐藏光标，但隐藏光标时，不方便操作UI，此时就需要显示光标。

通过修改角色控制器的 *显示鼠标光标（Show Mouse Cursor）* 属性，来控制是否显示光标。
