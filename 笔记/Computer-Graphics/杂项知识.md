## 射线经过平面检测
首先，对表示平面的数据进行压缩，使用一个 `vec4` 来进行表示，其中：
- `xyz`<br>表示为平面上的一个点
- `w`<br>表示为 $- N_{plane} \cdot P_{plane}$（使用平面法线点乘平面中的一点）

最后，可以使用下方的式子计算判断射线是否经过平面（将上方计算到的平面的值使用 $V_{plane}$ 来表示）：
$$
-\frac{V_{plane}\cdot {Ray}_{origin}}{V_{plane}.xyz \cdot {Ray}_{dir}} > 0
$$
如果计算到的结果大于0，表示射线经过平面；反之，不经过。

## Shading 和 Shadow
为了对图像的各个阶段进行区分，将认为 Shading 和 Shadow 是两个完全不同的阶段。
- Shading<br>着色阶段。根据像素本身，以及光的颜色，计算最终像素的颜色。
- Shadow<br>阴影。根据每个像素的可见性，计算阴影。

## 四元数

四元数的基础定义分为实部和虚部两个部分。
$$\rm q = \begin{bmatrix}a&b\rm{i}&c\rm{j}&d\rm{k}\end{bmatrix}$$

> 通常，也会使用 $\rm{q}=\begin{bmatrix}\rm{s}&\rm{v}\end{bmatrix}$ 来表示四元数。其中 $\rm{s}$ 表示实部，$\rm{v}$ 表示虚部。

在定义中，规定了虚部的四个虚数计算关系：
$$\begin{gathered}\rm i^2=j^2=k^2=ijk\\[2ex]\implies\begin{cases}\rm ij=-k\\\rm ik=-j\\\rm jk=-i\end{cases}\end{gathered}$$
如果按照具体的含义进行分析，满足一下关系（其中 $\rm{q}$ 是单位四元数）：
$$\begin{cases}\rm{q}=\begin{bmatrix}cos\cfrac{\theta}{2}&\rm{v}\end{bmatrix}\\||\rm{v}||=\sin\cfrac{\theta}{2}\end{cases}$$

> 虚部主要表示旋转轴，与实部配合，可以表示绕轴旋转角度 $\theta$

四元数转换旋转矩阵：
$$\rm R=\begin{bmatrix}\rm s^2+x^2-y^2-z^2&\rm 2(xy-sz)&\rm 2(xz+sy)\\\rm2(xy+sz)&\rm s^2-x^2+y^2-z^2&\rm 2(yz-sx)\\\rm 2(xz-sy)&\rm 2(yz+sx)&\rm s^2-x^2-y^2+z^2\end{bmatrix}$$